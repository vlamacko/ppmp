# ppmp - Predicting perturbations of modular proteins

ppmp is a Python module and command-line tool for investigating dynamics of 
modular protein structures. See Documentation section for more information.

### Content

1. Setup
1. Usage
   - functions
   - input data structure
1. Documentation
1. Progress

---

## Setup

### Using ppmp without installing it as a module

1. Clone this repo.
      ```bash
     git clone https://github.com/vlamacko/ppmp.git
     cd ppmp
     ```
1. Make sure all prerequisites are installed.
   - Python 3.2+
   - all dependencies:
      - statsmodels (conda, PyPI pip)
      - tqdm (PyPI pip)
      - scipy (conda, PyPI pip)
      - seaborn (conda, PyPI pip)
      - pandas (conda, PyPI pip)
      - numpy (conda, PyPI pip)
      - matplotlib (conda, PyPI pip)
      - biopython (conda, PyPI pip)

    Workflows:
      - __*Recomeneded:*__ Pipenv is the state of the art Python packaging tool. `Pipfile` and `Pipfile.lock` are available. To install all dependencies run:

        ```bash
        pipenv install  # for deterministic builds: using Pipfile.lock
        ```

        Or update to latest inter-compatible versions (compatibility with ppmp not guaranteed):
        ```bash
        pipenv update
        ```

        To run a script either use:
        ```bash
        pipenv run python <first-script-to-run>
        pipenv run python <second-script-to-run>
        ```

        Or spawn a sub-shell with the virtual enviroment activated:
        ```bash
        pipenv shell
        python <first-script-to-run>
        python <second-script-to-run>
        ```

      - *Alternatively:* Use `pip` and `virtualenv` to install the packages -- `requirements.txt` is supplied (generated by Pipenv) as a low level fallback:
        ```bash
        virtualenv --python=<path/to/your/python-3.2+> venv
        source ./venv/bin/activate           #activate the virtual environment
        pip install -r requirements.txt      #install packages into the virutal enviroment
        ```
        
    If using ppmp command-line tool only we can export the scripts to the PYTHONPATH 
    for increase ease of use:
    ```bash
    PYTHONPATH="$PWD/ppmp/:$PYTHONPATH"
    export PYTHONPATH
    ```

### Installing ppmp as a module

1. Clone this repo.
      ```bash
     git clone https://github.com/vlamacko/ppmp.git
     cd ppmp
     ```

1. Install the package in the environment/system. This should install all dependencies automatically.
    ```bash
    python setup.py install
    ```

## Usage

- Submodule `ppmp.to_rmsd_csv`
   - Script to calculate RMSD from pdb file and save it in csv files.
   - Can be used after importing the package or as a command-line tool (more
   options in command-line mode planned).
- Submodule `ppmp.model`
   - Script for analysing the RMSD csv files.
   - Can be used after importing the package or as a command-line tool (fully 
   functional).
- Submodule `ppmp.protein`
  - Used by the other submodules to define new class `Protein`.

For more information (docstrings, comments) see the source code. There are also 
few tests available in `/tests/` (both command-line and module use).

### Input data

The default folder structure/naming scheme is the following. It is partially 
adjustable. More options will be added in future. The `data` folder should be 
located in the working directory.
```text
data
├── csv  <------------------>  Directory containing RMSD csv files.
|                                 - form: proteinName.csv
├── json  <----------------->  Directory containg module json files.
|                                 - form: proteinName.csv
├── pdb  <------------------>  Directory containing structural pdb files.
|                                 - unpertubed: proteinName.pdb
|                                 - pertibations x: proteinName_x.pdb
├── test  <----------------->  Directory of test json and pdb files.
|                                 - structure: proteinName.json
|                                 - unpertubed: proteinName.pdb
|                                 - pertibations x: proteinName_x.pdb
└── modules-length  <------->  File defining length of each module.
```
~~See example data in `/tests/data/`.~~ The data will be released later.

### Output data

The output is saved in `out` folder in the current working directory. More 
customisation to be done.

## Documentation

This module has been created as a tool for an undergraduate 4 week project 
about predicting dynamics in modular protein structures. It was conducted by 5 
students of Engineering Mathematics at University of Bristol. The project report
`/docs/protein-dynamics-report.pdf` can be used as an additional documentation.

## Progress

- [x] finish writing README
- [x] create ./requirements.txt
- [x] create working tests
- [x] relative paths, should work on all OS
- [x] add paper as a doc
- [x] add missing graphs, code
- [x] create setup.py
- [x] ~~function annotations, type hints~~
- [x] test cross-platform compatibility
  - Ubuntu
- [x] test virtualenv (linux)
- [x] integrate `./tests/prediction_analysis.py` into the package